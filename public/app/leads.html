<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Leads | Home Fest</title>
  <link rel="stylesheet" href="/css/layout.css?v=20260127-180000">
  <link rel="stylesheet" href="/css/leads.css?v=20260127-180000">
  <script src="/permissions.js?v=20260127-180000" defer></script>
  <script src="/shell.js?v=20260127-180000" defer></script>
</head>
<body class="layout">

  
  <aside class="sidebar" aria-label="Navega√ß√£o">
    <div class="brand">
      <div class="brand-mark"><img class="brand-logo" src="/assets/logo.png" alt="Home Fest & Eventos" /></div>
      <div class="brand-text">
        <div class="brand-name">Home Fest</div>
        <div class="brand-sub">Sistema</div>
      </div>
    </div>

    <nav class="nav">
      <a class="nav-item" href="/app/dashboard" data-perm="dashboard:read"><span class="nav-ico">üè†</span><span>Dashboard</span></a><a class="nav-item is-active" href="/app/leads" data-perm="leads:read"><span class="nav-ico">üß≤</span><span>Leads</span></a><a class="nav-item" href="/app/clientes" data-perm="clientes:read"><span class="nav-ico">üë•</span><span>Clientes</span></a><a class="nav-item" href="/app/festas" data-perm="eventos:read"><span class="nav-ico">üéâ</span><span>Festas</span></a><a class="nav-item" href="/app/financeiro" data-perm="financeiro:read"><span class="nav-ico">üí∞</span><span>Financeiro</span></a><a class="nav-item" href="/app/usuarios" data-perm="usuarios:read"><span class="nav-ico">üõ°Ô∏è</span><span>Usu√°rios</span></a><button class="nav-item" type="button" disabled title="Em desenvolvimento"><span class="nav-ico">üìÑ</span><span>Contratos</span></button><button class="nav-item" type="button" disabled title="Em desenvolvimento"><span class="nav-ico">üè∑Ô∏è</span><span>Patrim√¥nio</span></button><button class="nav-item" type="button" disabled title="Em desenvolvimento"><span class="nav-ico">üìä</span><span>Relat√≥rios</span></button>
      <div class="nav-sep"></div>
</nav>

    <div class="sidebar-footer">
      <a class="nav-item" id="btnLogout" href="#" title="Sair"><span class="nav-ico">üö™</span><span>Sair</span></a>
<div class="sidebar-meta">
        <div class="meta-label">Vers√£o</div>
        <div class="meta-value">0.1</div>
      </div>
      <a class="settings-link" href="/app/permissoes" data-perm="permissoes:read">‚öô Configura√ß√µes</a>
</div>
  </aside>


  <main class="main">
    <div class="page-head">
      <div>
        <h1>CRM ¬∑ Leads</h1>
        <p class="muted">Organize o funil, registre hist√≥rico e converta em Cliente + Festa.</p>
      </div>

      <div class="page-actions">
        <div class="search">
          <span class="search-ico">üîé</span>
          <input id="q" placeholder="Buscar por nome, telefone, origem..." autocomplete="off">
        </div>
        <button class="btn-ghost" id="btnToggleNovo" data-perm="leads:create">+ Novo lead</button>
      </div>
    </div>

    <section class="card" id="novoLeadCard" hidden>
      <div class="card-head">
        <h3>Novo lead</h3>
        <span class="pill">Capta√ß√£o</span>
      </div>

      <div class="form-grid">
        <label>Nome
          <input id="nome" placeholder="Nome completo">
        </label>
        <label>Telefone
          <input id="telefone" placeholder="(31) 9....">
        </label>
        <label>Email
          <input id="email" placeholder="email@exemplo.com">
        </label>
        <label>Cidade
          <input id="cidade" placeholder="Belo Horizonte">
        </label>
        <label>Bairro
          <input id="bairro" placeholder="Buritis">
        </label>
        <label>Origem
          <input id="origem" placeholder="WhatsApp, Instagram, Google...">
        </label>
        <label>Status
          <select id="status">
            <option value="novo">Novo</option>
            <option value="em_atendimento">Em atendimento</option>
            <option value="orcamento_enviado">Or√ßamento enviado</option>
            <option value="follow_up">Follow-up</option>
            <option value="fechado">Fechado</option>
            <option value="perdido">Perdido</option>
          </select>
        </label>
        <label class="span-2">Observa√ß√µes
          <textarea id="observacoes" placeholder="Resumo do pedido, data prov√°vel, prefer√™ncias..."></textarea>
        </label>
      </div>

      <div class="actions">
        <button class="btn-ghost" id="btnCancelarNovo">Cancelar</button>
        <button class="btn-primary" id="btnSalvarLead" data-perm="leads:create">Salvar lead</button>
      </div>
    </section>

    <section class="kanban" aria-label="Pipeline de leads">
      <div class="kanban-col" data-status="novo">
        <div class="kanban-head">
          <span class="k-title">Novo</span>
          <span class="k-count" id="count_novo">0</span>
        </div>
        <div class="kanban-drop" data-drop="novo"></div>
      </div>

      <div class="kanban-col" data-status="em_atendimento">
        <div class="kanban-head">
          <span class="k-title">Em atendimento</span>
          <span class="k-count" id="count_em_atendimento">0</span>
        </div>
        <div class="kanban-drop" data-drop="em_atendimento"></div>
      </div>

      <div class="kanban-col" data-status="orcamento_enviado">
        <div class="kanban-head">
          <span class="k-title">Or√ßamento enviado</span>
          <span class="k-count" id="count_orcamento_enviado">0</span>
        </div>
        <div class="kanban-drop" data-drop="orcamento_enviado"></div>
      </div>

      <div class="kanban-col" data-status="follow_up">
        <div class="kanban-head">
          <span class="k-title">Follow-up</span>
          <span class="k-count" id="count_follow_up">0</span>
        </div>
        <div class="kanban-drop" data-drop="follow_up"></div>
      </div>

      <div class="kanban-col" data-status="fechado">
        <div class="kanban-head">
          <span class="k-title">Fechado</span>
          <span class="k-count" id="count_fechado">0</span>
        </div>
        <div class="kanban-drop" data-drop="fechado"></div>
      </div>

      <div class="kanban-col" data-status="perdido">
        <div class="kanban-head">
          <span class="k-title">Perdido</span>
          <span class="k-count" id="count_perdido">0</span>
        </div>
        <div class="kanban-drop" data-drop="perdido"></div>
      </div>
    </section>

    <!-- Lead details drawer -->
    <div class="drawer hidden" id="drawer" aria-hidden="true">
      <div class="drawer-panel">
        <div class="drawer-head">
          <div>
            <div class="drawer-title" id="d_nome">Lead</div>
            <div class="drawer-sub muted" id="d_sub"></div>
          </div>
          <button class="icon-btn" id="btnFecharDrawer" aria-label="Fechar">‚úï</button>
        </div>

        <div class="drawer-body">
          <div class="drawer-grid">
            <div class="info">
              <div class="info-row"><span class="label">Telefone</span><span class="value" id="d_tel">‚Äî</span></div>
              <div class="info-row"><span class="label">Email</span><span class="value" id="d_email">‚Äî</span></div>
              <div class="info-row"><span class="label">Cidade/Bairro</span><span class="value" id="d_local">‚Äî</span></div>
              <div class="info-row"><span class="label">Origem</span><span class="value" id="d_origem">‚Äî</span></div>
            </div>

            <div class="controls">
              <label>Status
                <select id="d_status">
                  <option value="novo">Novo</option>
                  <option value="em_atendimento">Em atendimento</option>
                  <option value="orcamento_enviado">Or√ßamento enviado</option>
                  <option value="follow_up">Follow-up</option>
                  <option value="fechado">Fechado</option>
                  <option value="perdido">Perdido</option>
                </select>
              </label>

              <div class="quick">
                <button class="btn-primary" id="btnConverter" data-perm="leads:update">Converter em Cliente + Festa</button>
                <button class="btn-ghost" id="btnEditar" data-perm="leads:update">Editar lead</button>
                <a class="btn-ghost" id="btnWhats" href="#" target="_blank" rel="noopener">WhatsApp</a>
                <button class="btn-danger" id="btnExcluir" data-perm="leads:delete">Excluir lead</button>
              </div>

              <div class="hint muted">Dica: voc√™ pode arrastar o card para mover de coluna.</div>
            </div>
          </div>

          <!-- Edit lead (hidden by default) -->
          <section class="edit-lead" id="editLead" hidden>
            <div class="edit-head">
              <h3>Editar lead</h3>
              <span class="pill">dados</span>
            </div>

            <div class="form-grid">
              <label>Nome
                <input id="e_nome" placeholder="Nome completo" />
              </label>
              <label>Telefone
                <input id="e_telefone" placeholder="(31) 9...." />
              </label>
              <label>Email
                <input id="e_email" placeholder="email@exemplo.com" />
              </label>
              <label>Cidade
                <input id="e_cidade" placeholder="Belo Horizonte" />
              </label>
              <label>Bairro
                <input id="e_bairro" placeholder="Buritis" />
              </label>
              <label>Origem
                <input id="e_origem" placeholder="WhatsApp, Instagram, Google..." />
              </label>
              <label class="span-2">Observa√ß√µes
                <textarea id="e_observacoes" placeholder="Resumo do pedido, data prov√°vel, prefer√™ncias..."></textarea>
              </label>
            </div>

            <div class="actions">
              <button class="btn-ghost" id="btnCancelarEdit">Cancelar</button>
              <button class="btn-primary" id="btnSalvarEdit" data-perm="leads:update">Salvar altera√ß√µes</button>
            </div>
          </section>

          <div class="notes">
            <div class="notes-head">
              <h3>Hist√≥rico</h3>
              <span class="pill">anota√ß√µes</span>
            </div>

            <div class="note-new">
              <textarea id="noteText" placeholder="Registrar contato, obje√ß√µes, prefer√™ncias..."></textarea>
              <div class="note-actions">
                <button class="btn-ghost" id="btnNoteClear">Limpar</button>
                <button class="btn-primary" id="btnAddNote" data-perm="leads:update">Salvar nota</button>
              </div>
            </div>

            <div class="note-list" id="notesList"></div>
          </div>
        </div>
      </div>
      <div class="drawer-backdrop" id="drawerBackdrop" aria-hidden="true"></div>
    </div>
  </main>

  <!-- MODAL FECHAR CONTRATO -->
  <div id="modal" class="modal hidden" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Converter em Cliente + Festa</h3>
        <button class="icon-btn" onclick="fecharModal()">‚úï</button>
      </div>

      <div class="modal-body">
        <p class="muted">Lead: <strong id="modalLeadNome"></strong></p>

        <div class="grid-2">
          <label>
            Tipo de evento
            <select id="m_tipo_evento">
              <option value="Infantil">Infantil</option>
              <option value="Adulto">Adulto</option>
              <option value="Casamento">Casamento</option>
              <option value="Corporativo">Corporativo</option>
              <option value="Outro">Outro</option>
            </select>
          </label>

          <label>
            Status da festa
            <select id="m_status_evento">
              <option value="orcamento">Or√ßamento</option>
              <option value="confirmado">Confirmado</option>
              <option value="fechado">Fechado</option>
            </select>
          </label>

          <label>
            Data do evento
            <input id="m_data_evento" type="date" />
          </label>

          <label>
            Convidados (estimativa)
            <input id="m_convidados" type="number" min="0" placeholder="0" />
          </label>

          <label>
            Valor total do contrato (R$)
            <input id="m_valor_total" type="number" min="0" step="0.01" placeholder="0,00" />
          </label>

          <label>
            Valor do sinal (R$)
            <input id="m_valor_sinal" type="number" min="0" step="0.01" placeholder="0,00" />
          </label>

          <label>
            Forma de pagamento
            <select id="m_forma_pagamento">
              <option value="50% agora e 50% at√© 1 semana antes">50% agora e 50% at√© 1 semana antes</option>
              <option value="√Ä vista (desconto)">√Ä vista (desconto)</option>
              <option value="Cart√£o (at√© 6x)">Cart√£o (at√© 6x)</option>
              <option value="Outro">Outro</option>
            </select>
          </label>
        </div>

        <label class="block">
          Observa√ß√µes internas (opcional)
          <textarea id="m_obs" placeholder="Ex: combinado decora√ß√£o inclusa, detalhes do pacote, etc."></textarea>
        </label>
      </div>

      <div class="modal-footer">
        <button class="btn-ghost" onclick="fecharModal()">Cancelar</button>
        <button class="btn-primary" onclick="confirmarFechamento()">Converter</button>
      </div>
    </div>
  </div>

  <script src="/js/leads.js?v=20260127-180000"></script>
</body>
</html>
